# ğŸ DomyÅ›lny cel
.DEFAULT_GOAL := help

# ğŸ§ª AKTUALIZACJA SCHEMATU
init:
	@echo "ğŸ”§ Aktualizacja struktury bazy danych..."
       python3 -m scraper.services.update_schema

# ğŸ” SCRAPOWANIE â€“ wszystkie produkty
scrape:
	@echo "ğŸ” Scraping all products (GUI browser)..."
       python3 -m scraper.services.update_schema
       python3 -m scraper.cli.scrape_all

# ğŸ” SCRAPOWANIE â€“ headless
scrape-headless:
	@echo "ğŸ” Scraping all products (headless)..."
       python3 -m scraper.services.update_schema
       python3 -m scraper.core.main --headless

# ğŸ” SCRAPUJ KONKRETNY PRODUKT
scrape-product:
	@echo "ğŸ” Scraping product ID: $(PRODUCT)"
       python3 -m scraper.services.update_schema
       python3 -m scraper.core.main --product $(PRODUCT)

# ğŸ” SCRAPUJ PRODUKT (HEADLESS)
scrape-product-headless:
	@echo "ğŸ” Scraping product ID: $(PRODUCT) (headless)"
       python3 -m scraper.services.update_schema
       python3 -m scraper.core.main --product $(PRODUCT) --headless

# ğŸ“ˆ ANALIZA CEN CLI
analyze:
	@echo "ğŸ“ˆ Running CLI analysis..."
       python3 -m scraper.services.update_schema
       python3 -m scraper.cli.analyze_prices --trend

# ğŸš¨ ALERTY CENOWE
alerts:
	@echo "ğŸš¨ PokazujÄ™ okazje cenowe..."
       python3 -m scraper.services.update_schema
       python3 -m scraper.cli.check_alerts

# ğŸ“¦ PODGLÄ„D BAZY
check:
	@echo "ğŸ” WyÅ›wietlam ostatnie wpisy z bazy..."
       python3 -m scraper.services.update_schema
       python3 -m scraper.cli.check_db

# ğŸ§¼ CZYSZCZENIE PLIKÃ“W I LOGÃ“W
clean:
	@echo "ğŸ§¹ Czyszczenie danych i logÃ³w..."
	rm -rf data/*.json logs/*.log


reset-db:
	@echo "ğŸ—‘ï¸ Usuwam starÄ… bazÄ™..."
	rm -f pharmacy_prices.sqlite
	@echo "ğŸ§± TworzÄ™ nowÄ… strukturÄ™..."
       python3 -m scraper.services.update_schema


# ğŸ†˜ POMOC
help:
	@echo ""
	@echo "ğŸ› ï¸  DostÄ™pne komendy:"
	@echo ""
	@echo "  make init                    - Inicjalizacja / aktualizacja bazy"
	@echo "  make scrape                  - Scrape all products (GUI browser)"
	@echo "  make scrape-headless         - Scrape all products (headless)"
	@echo "  make scrape-product PRODUCT=ID         - Scrape specific product"
	@echo "  make scrape-product-headless PRODUCT=ID - Headless for product"
	@echo "  make analyze                 - Run price analysis CLI"
	@echo "  make alerts                  - Show low price alerts"
	@echo "  make check                   - Show last rows from DB"
	@echo "  make clean                   - Delete logs and JSON files"
	@echo ""
